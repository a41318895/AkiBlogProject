webpackJsonp([6],{mvHQ:function(s,e,a){s.exports={default:a("qkKv"),__esModule:!0}},psK5:function(s,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("mvHQ"),r=a.n(t),i=a("Dd8w"),n=a.n(i),o=a("Cz8s"),l=a("vMJZ"),c=a("IcnI"),u=a("TIfe"),f={name:"UserInfo",data:function(){return{uploadURL:"",isEdit:!1,userInfo:{},originalUserInfoObj:"",userInfoObj:"",uploadHeaders:{token:Object(u.a)()}}},methods:{handleAvatarSuccess:function(s,e){console.log(s),200==s.code?(this.userInfoObj.avatar=s.data,this.userInfoObj.head_start=1):this.$message.error("上傳圖片失敗")},beforeAvatarUpload:function(s){var e="image/png"==s.type||"image/jpg"==s.type||"image/jpeg"==s.type,a=s.size/1024/1024<2;return e||this.$message.error("上傳大頭貼圖片只能為 JPG/PNG 格式 !"),a||this.$message.error("上傳大頭貼圖片大小不能超過 2MB !"),e&&a},saveInfoFun:function(){var s=this;s.userInfoObj.nickName?Object(l.e)(s.userInfoObj).then(function(e){s.$message.success("保存成功！"),Object(l.b)().then(function(e){s.userInfoObj=e,s.userInfo=n()({},s.userInfo,s.userInfoObj),localStorage.setItem("userInfo",r()(s.userInfo)),s.isEdit=!1}).catch(function(e){s.$message.error("獲取最新用戶資料失敗，請重試！"),console.error(e)})}).catch(function(e){s.$message.error("保存失敗，請重試！"),console.error(e)}):s.$message.error("暱稱為必填欄位，請填寫暱稱")},routeChange:function(){var s=this,e=this;if(localStorage.getItem("userInfo")){e.haslogin=!0;try{e.userInfo=JSON.parse(localStorage.getItem("userInfo")),e.userId=e.userInfo.id,Object(l.b)().then(function(a){e.userInfoObj=a,s.originalUserInfoObj=JSON.parse(r()(a)),e.userInfoObj.head_start=0})}catch(s){console.error("Error parsing userInfo from localStorage:",s)}}else e.haslogin=!1},cancelEdit:function(){this.userInfoObj=JSON.parse(r()(this.originalUserInfoObj)),this.isEdit=!1}},components:{"wbc-nav":o.a},watch:{$route:"routeChange"},created:function(){this.routeChange(),this.uploadURL=c.a.state.baseURL+"upload"}},v={render:function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("div",[a("wbc-nav"),s._v(" "),a("div",{staticClass:"container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:s.isEdit,expression:"isEdit"}],staticClass:"tcommonBox"},[s._m(0),s._v(" "),a("section",[a("ul",{staticClass:"userInfoBox"},[a("li",{staticClass:"avatarlist"},[a("span",{staticClass:"leftTitle"},[s._v("大頭貼")]),s._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{name:"img",action:s.uploadURL,"show-file-list":!1,"on-success":s.handleAvatarSuccess,"before-upload":s.beforeAvatarUpload,headers:s.uploadHeaders}},[s.userInfoObj.avatar?a("img",{staticClass:"avatar",attrs:{src:s.userInfoObj.avatar?s.userInfoObj.avatar:"static/img/defaultHead.jpg",onerror:s.$store.state.errorImg}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),s._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s._v("點擊以上傳大頭貼, 只能上傳jpg/png文件, 且大小不超過2MB")])])],1),s._v(" "),a("li",{staticClass:"username"},[a("span",{staticClass:"leftTitle"},[s._v("暱稱")]),s._v(" "),a("el-input",{attrs:{placeholder:"暱稱"},model:{value:s.userInfoObj.nickName,callback:function(e){s.$set(s.userInfoObj,"nickName",e)},expression:"userInfoObj.nickName"}}),s._v(" "),a("i",{staticClass:"fa fa-wa fa-asterisk"})],1),s._v(" "),a("li",[a("span",{staticClass:"leftTitle"},[s._v("電子郵件")]),s._v(" "),a("el-input",{attrs:{placeholder:"電子郵件"},model:{value:s.userInfoObj.email,callback:function(e){s.$set(s.userInfoObj,"email",e)},expression:"userInfoObj.email"}}),s._v(" "),a("i",{staticClass:"fa fa-wa fa-asterisk"})],1),s._v(" "),a("li",[a("span",{staticClass:"leftTitle"},[s._v("性别")]),s._v(" "),[a("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:s.userInfoObj.sex,callback:function(e){s.$set(s.userInfoObj,"sex",e)},expression:"userInfoObj.sex"}},[s._v("男")]),s._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:s.userInfoObj.sex,callback:function(e){s.$set(s.userInfoObj,"sex",e)},expression:"userInfoObj.sex"}},[s._v("女")])]],2)]),s._v(" "),a("div",{staticClass:" saveInfobtn"},[a("a",{staticClass:"tcolors-bg",attrs:{href:"javascript:void(0);"},on:{click:s.cancelEdit}},[s._v("返 回")]),s._v(" "),a("a",{staticClass:"tcolors-bg",attrs:{href:"javascript:void(0);"},on:{click:s.saveInfoFun}},[s._v("保 存")])])])]),s._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!s.isEdit,expression:"!isEdit"}],staticClass:"tcommonBox"},[a("header",[a("h1",[s._v("\n                        個人中心\n                    "),a("span",{staticClass:"gotoEdit",on:{click:function(e){s.isEdit=!s.isEdit}}},[a("i",{staticClass:"fa fa-wa fa-edit"}),s._v("編輯")])])]),s._v(" "),a("section",[a("ul",{staticClass:"userInfoBox"},[a("li",{staticClass:"avatarlist"},[a("span",{staticClass:"leftTitle"},[s._v("大頭貼")]),s._v(" "),a("div",{staticClass:"avatar-uploader"},[a("img",{staticClass:"avatar",attrs:{src:s.userInfoObj.avatar?s.userInfoObj.avatar:"static/img/defaultHead.jpg",onerror:s.$store.state.errorImg}})])]),s._v(" "),a("li",{staticClass:"username"},[a("span",{staticClass:"leftTitle"},[s._v("暱稱")]),s._v(" "),a("span",[s._v(s._s(s.userInfoObj.nickName?s.userInfoObj.nickName:"無"))])]),s._v(" "),a("li",[a("span",{staticClass:"leftTitle"},[s._v("電子郵件")]),s._v(" "),a("span",[s._v(s._s(s.userInfoObj.email?s.userInfoObj.email:"無"))])]),s._v(" "),a("li",[a("span",{staticClass:"leftTitle"},[s._v("性别")]),s._v(" "),a("span",[s._v(s._s(0==s.userInfoObj.sex?"男":"女"))])])])])])])],1)},staticRenderFns:[function(){var s=this.$createElement,e=this._self._c||s;return e("header",[e("h1",[this._v("\n                        編輯個人資料\n                ")])])}]};var d=a("VU/8")(f,v,!1,function(s){a("tXV+")},null,null);e.default=d.exports},qkKv:function(s,e,a){var t=a("FeBl"),r=t.JSON||(t.JSON={stringify:JSON.stringify});s.exports=function(s){return r.stringify.apply(r,arguments)}},"tXV+":function(s,e){}});